# マイページ編集機能の設計

## 背景

現在の `/mypage` は、確認と編集が混在している状態です。

**問題点**：
- 表示名の編集フォームと保存ボタンが常に表示されている
- 自己紹介の編集フォームと保存ボタンが常に表示されている
- 確認と編集の役割が曖昧

**目指す姿**：
- マイページ = 自分のプロフィールを確認できるページ（確認のみ）
- 編集したい項目だけを選択的に編集できる

## 検討した2つの案

### A案：完全分離（/mypage と /edit）

```
/mypage  → 確認のみ（編集不可）
/edit    → 編集専用ページ
```

**メリット**：
- URL構造が明確
- 確認と編集の役割が明確に分離
- 実装がシンプル

**デメリット**：
- ページ遷移が増える（モバイルで戻る操作が必要）
- 編集のたびに別ページに移動する手間

### B案：動的UI（編集ボタンで切り替え）✅ 採用

```
/mypage で以下を切り替え：
[確認モード] 表示名: けもの太郎 [編集]
           ↓ タップ
[編集モード] [入力欄] ✓保存 ✕キャンセル
```

**メリット**：
- ページ遷移なし（モバイルでスムーズ）
- ワンタップで編集モードに
- 編集→保存→確認が同じページ内で完結

**デメリット**：
- クライアント状態管理が必要
- コードがやや複雑になる

**採用理由**：
- モバイルファーストの観点から、ページ遷移が少ない方が使いやすい
- 「ちょっと修正」がスムーズに行える

## 決定した設計（B案）

### UI構成

#### 確認モード（デフォルト）

```
┌─────────────────────────┐
│  マイページ             │
├─────────────────────────┤
│ 👤 けもの太郎           │
│                         │
│ 表示名                  │
│ けもの太郎       [編集] │
│                         │
│ 自己紹介                │
│ 同人イベント参加してます │
│                  [編集] │
│                         │
│ SNSアカウント           │
│ @kemono_taro     [編集] │
└─────────────────────────┘
```

#### 編集モード（項目ごとに展開）

```
┌─────────────────────────┐
│ 表示名                  │
│ ┌─────────────────────┐ │
│ │けもの太郎           │ │ ← 入力欄
│ └─────────────────────┘ │
│ ✓保存  ✕キャンセル      │ ← この項目だけ
├─────────────────────────┤
│ 自己紹介                │
│ 同人イベント参加してます │
│                  [編集] │ ← 他は確認モード
└─────────────────────────┘
```

### 操作フロー

1. **確認モード** → 各項目に [編集] ボタンが表示
2. **[編集] タップ** → その項目だけ入力欄に変化
3. **編集中** → 他の項目は確認モードのまま
4. **✓保存** → サーバーに保存して確認モードに戻る
5. **✕キャンセル** → 変更を破棄して確認モードに戻る

### 編集確定の仕組み

**採用パターン：アイコン＋文字ボタン**

```
[けもの太郎_____] ✓保存  ✕キャンセル
```

**理由**：
- コンパクトでスペース効率が良い
- アイコン（✓✕）は視覚的に直感的
- 文字も併記することで意味が明確
- タップしやすいサイズに調整可能
- モバイルファーストに適している

**検討した他のパターン**：
- 保存/キャンセルボタンのみ → スペースを取りすぎる
- アイコンのみ → 意味が不明確な可能性
- Enter/Escキー → モバイルでは不便

### 実装上の注意点

- サイズ調整は実装時に行う
- 保存中の状態表示（ローディング）を考慮
- 保存失敗時のエラーハンドリング
- 複数項目を同時に編集できないようにする（オプション）

## 他サービスの事例

参考として：
- **Instagram**: プロフィール編集は別ページ（A案）
- **Twitter/X**: プロフィール編集は専用モーダル
- **LINE**: プロフィールは確認のみ、編集は別画面（A案）
- **Notion**: その場で編集、自動保存（B案に近い）

## 実装対象ページ

- `/src/app/mypage/page.tsx` を改修
- 現在の編集フォームを動的UIに変更

## 今後の拡張可能性

- 自動保存機能（debounce付き）
- 楽観的UI更新（Optimistic Updates）
- 複数項目の一括編集モード
